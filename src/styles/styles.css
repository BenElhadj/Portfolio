/* ==========================================================================
   VARIABLES CSS - ORGANISÉES PAR CATÉGORIES
   ========================================================================== */
@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');

:root {
  /* ===== TYPOGRAPHIE ===== */
  --font-family-base: system-ui, Avenir, Helvetica, Arial, sans-serif;
  --font-family-montserrat: 'Montserrat', system-ui, Avenir, Helvetica, Arial, sans-serif;
  --font-family-arabic: system-ui, "BArabics", "Amiri", "Cairo", Arial, sans-serif;
  --line-height: 1.5;
  --font-weight: 400;
  
  /* Tailles de police responsive */
  --fs-h1: clamp(2.1rem, 5vw, 4.7rem);
  --fs-name-height: clamp(2.7rem, 1vw, 3.2rem);
  --fs-h2: clamp(1.7rem, 4vw, 2.4rem);
  --fs-h3: clamp(1.3rem, 2vw, 1.9rem);
  --fs-body: clamp(1rem, 1.2vw, 1.5rem);
  --fs-small: clamp(0.8rem, 1vw, 1.2rem);
  
  /* ===== COULEURS - MODE CLAIR (DÉFAUT) ===== */
  --page-bg: #ffffff;
  --text: #111111;
  --text-secondary: #444444;
  --title: #0b6fb8;
  --blue: #0b6fb8;
  --border: #e6e6e6;
  --green-glow: #34D399;
  
  /* Cartes */
  --card-bg: #ffffff;
  --card-shadow: rgba(0, 0, 0, 0.06);
  
  /* Barres de progression */
  --bar-bg: #e5e7eb;
  --bar-fill: linear-gradient(90deg, #0ea5e9, #60a5fa);
  
  /* Scrollbar */
  --scrollbar-track: #f1f1f1;
  --scrollbar-thumb: #0b6fb8;
  
  /* Catégories timeline */
  --cat-formation: #0ea5e9;
  --cat-stage: #f59e0b;
  --cat-travail: #22c55e;
  --cat-autre: #a78bfa;
  
  /* Catégories overlay */
  --formation-color: #2e86de;
  --stage-color: #f9ca24;
  --travail-color: #27ae60;
  --autre-color: #dc6bff;
  
  /* ===== DIMENSIONS ===== */
  --radius: 8px;
  --navbar-height: 36px;
  /* padding horizontal moins progressif : min 6px, faible scaling, max 10px */
  --page-padding-x: clamp(7px, 1vw, 24px);
  --page-padding-y: clamp(4px, 1vw, 24px);
  --wrapper-padding-top: 16px;
  --degree-thumb-width: clamp(1.9rem, 5vw, 2.7rem);
  
  /* Bandeau nom */
  --name-banner-height: clamp(1.9rem, 5vw, 2.7rem);
  --name-banner-color: #000000;
  
  /* QR Codes - valeurs par défaut pour desktop */
  --corner-qr-size: 167px;
  --corner-qr-margin: clamp(2px, 2vw, 36px);
  /* Marges directionnelles autour du QR (top / left / right).
    Par défaut on répartit la marge horizontale en deux pour garder
    le comportement visuel précédent. */
  --corner-qr-margin-top: var(--corner-qr-margin);
  --corner-qr-margin-left: calc(var(--corner-qr-margin) / 2);
  --corner-qr-margin-right: calc(var(--corner-qr-margin) / 2);
  --favicon-size: clamp(95px, 15vw, 820px);
  
  /* Bouton Telegram */
  --tg-size: 80px;
  --tg-scale: 1;
  --tg-flip: scaleX(1);
  --tg-icon-offset: 8px;
  
  /* Grille quadrillée */
  --grid-size: 42px;
  --grid-line: color-mix(in hsl, var(--text), transparent 87%);

  /* ===== ESPACEMENTS (clamp-based responsive spacing) ===== */
  --pad-xs: clamp(4px, 1.2vw, 8px);
  --pad-sm: clamp(6px, 1.5vw, 12px);
  --pad-md: clamp(12px, 2.2vw, 20px);
  --pad-lg: clamp(16px, 3vw, 32px);
  --pad-xxs: clamp(1px, 0.6vw, 4px);
  /* Espacement unifié entre les sous-sections (horizontal & vertical) */
  --sub-gap: clamp(8px, 2vw, 24px);
}

/* ===== MODE SOMBRE ===== */
.dark {
  --page-bg: #121212;
  --text: #f3f4f6;
  --text-secondary: #bdbdbd;
  --title: #60a5fa;
  --blue: #60a5fa;
  --border: #2b2b2b;
  --green-glow: #34D399;
  
  --card-bg: #1e1e1f;
  --card-shadow: rgba(0, 0, 0, 0.6);
  
  --bar-bg: #2a2a2a;
  --bar-fill: linear-gradient(90deg, #3b82f6, #60a5fa);
  
  --scrollbar-track: #1e1e1e;
  --scrollbar-thumb: #3b82f6;
  
  --cat-formation: #38bdf8;
  --cat-stage: #fbbf24;
  --cat-travail: #4ade80;
  --cat-autre: #c4b5fd;
  
  --name-banner-color: #ffffff;
  
  --grid-line: color-mix(in hsl, var(--text), transparent 87%);
}

/* ==========================================================================
   RESET ET STYLES GÉNÉRAUX
   ========================================================================== */

html, body, #app {
  margin: 0;
  height: 100%;
  width: 100%;
  color: var(--text);
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Police Montserrat pour tout sauf arabe */
html, body, :not([lang="ar"]):not([dir="rtl"]) {
  font-family: var(--font-family-montserrat);
}

/* Police système pour arabe */
[lang="ar"], [dir="rtl"] {
  font-family: var(--font-family-arabic);
}

html {
  background-color: var(--page-bg);
}

body, #app {
  background: transparent;
}

#app {
  position: relative;
  z-index: 1;
}

/* ==========================================================================
   FOND QUADRILLÉ AVEC MASQUE DIAGONAL
   ========================================================================== */
html::before {
  content: "";
  position: fixed;
  inset: 0;
  z-index: 0;
  pointer-events: none;
  filter: blur(2px);
  
  /* Grille transparente */
  background:
    linear-gradient(90deg, var(--grid-line) 1px, transparent 1px var(--grid-size)) 0 0 / var(--grid-size) var(--grid-size),
    linear-gradient(var(--grid-line) 1px, transparent 1px var(--grid-size)) 0 0 / var(--grid-size) var(--grid-size);
  
  /* Masque diagonal */
  -webkit-mask-image: linear-gradient(
    135deg,
    rgba(0, 0, 0, 1) 0%,
    rgba(0, 0, 0, 1) 45%,
    rgba(0, 0, 0, 0.6) 55%,
    rgba(0, 0, 0, 0.2) 65%,
    rgba(0, 0, 0, 0) 75%
  );
  mask-image: linear-gradient(
    135deg,
    rgba(0, 0, 0, 1) 0%,
    rgba(0, 0, 0, 1) 45%,
    rgba(0, 0, 0, 0.6) 55%,
    rgba(0, 0, 0, 0.2) 65%,
    rgba(0, 0, 0, 0) 75%
  );
}

/* ==========================================================================
   TYPOGRAPHIE
   ========================================================================== */
h1, .h1, h2, .h2, h3, .h3 {
  margin: 0;
  color: var(--title);
}

h1, .h1 { font-size: var(--fs-h1); }
h2, .h2 { font-size: var(--fs-h2); }
h3, .h3 { font-size: var(--fs-h3); color: var(--text); }

p, li, span, div, small {
  font-size: var(--fs-body);
  color: var(--text);
}

small {
  font-size: var(--fs-small);
  color: var(--text-secondary);
}

.group-title {
  color: var(--title);
  font-size: var(--fs-h3);
  margin-bottom: var(--pad-md);
}

/* ==========================================================================
   LAYOUTS DE PAGES
   ========================================================================== */
.page-layout {
  width: 100%;
  height: 100%;
  display: grid;
  gap: var(--sub-gap);
  overflow: hidden;
  position: relative;
  background-color: var(--page-bg);
  color: var(--text);
  /* utiliser le padding horizontal centralisé et réduit */
  padding-inline: var(--page-padding-x);
  /* reserve space vertically as well so top/bottom glows are visible */
  padding-block: var(--page-padding-y);
  box-sizing: border-box;
}

/* Grille quadrillée interne aux pages */
.page-layout::before {
  content: "";
  position: absolute;
  inset: 0;
  z-index: 0;
  pointer-events: none;
  filter: blur(1px);
  --line: color-mix(in hsl, var(--text), transparent 94%);
  background:
    linear-gradient(90deg, var(--line) 1px, transparent 1px var(--grid-size)) 0 0 / var(--grid-size) var(--grid-size),
    linear-gradient(var(--line) 1px, transparent 1px var(--grid-size)) 0 0 / var(--grid-size) var(--grid-size);
}

/* Configurations de grille */
.two-cols { grid-template-columns: 1fr 1fr; grid-template-rows: 1fr; }
.two-rows { grid-template-columns: 1fr; grid-template-rows: 1fr 1fr; }
.grid-2x2 { grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; }

.pages {
  height: 100%;
  overflow-y: auto;
  scroll-snap-type: y mandatory;
  scroll-behavior: smooth;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.page {
  height: 100vh;
  /* box-sizing: border-box; */
  scroll-snap-align: start;
  display: flex;
  flex-direction: column;
  gap: var(--sub-gap);
  flex-direction: column;
  align-items: stretch;
  will-change: transform;
  padding: 
    calc(var(--navbar-height) + var(--name-banner-height) + var(--fs-small))
    var(--page-padding-x)
    var(--page-padding-y);
}

.section {
  height: calc(100vh - var(--navbar-height));
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  font-size: var(--fs-h2);
  background: var(--page-bg);
  border-bottom: 1px solid var(--border);
  scroll-snap-align: start;
  color: var(--text);
  padding-top: var(--navbar-height);
}

.wrapper {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  padding: 0 var(--page-padding-x);
  gap: var(--sub-gap);
  box-sizing: border-box;
}

/* ==========================================================================
   COMPARTIMENTS (SUB-SECTIONS)
   ========================================================================== */
.sub-section {
  padding: var(--pad-xs);
  box-sizing: border-box;
  overflow: visible;
  border-radius: var(--radius);
  /* margin managed by the container gap: use 0 here to avoid double spacing */
  margin: 0;
  position: relative;
  z-index: 1;
  will-change: transform;
  transition: filter 160ms ease, box-shadow 160ms ease;
  scrollbar-width: thin;
  scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-track);
  background: var(--card-bg);
  color: var(--text);
  border: 1px solid var(--border);
}

/* Conteneur interne scrollable */
.sub-section .sub-inner {
  width: 100%;
  height: 100%;
  overflow-y: auto;
  box-sizing: border-box;
  padding: var(--pad-sm);
  background: transparent;
  scrollbar-width: thin;
  scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-track);
}

/* Glow externe au survol */
html.has-scrolled .sub-section:hover,
html.has-scrolled .sub-section:focus-within {
  filter: drop-shadow(0 0 16px color-mix(in hsl, var(--blue), transparent 78%));
  box-shadow: 0 0 8px color-mix(in hsl, var(--blue), transparent 90%);
  z-index: 2998;
}

/* Couche de glow au-dessus du contenu */
.sub-section::after {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  opacity: 0;
  transition: opacity 160ms ease;
  border-radius: inherit;
  z-index: 2999;
  box-shadow: 0 0 18px 6px color-mix(in hsl, var(--blue), transparent 82%);
}

html.has-scrolled .sub-section:hover::after,
html.has-scrolled .sub-section:focus-within::after {
  opacity: 1;
}

/* Alignement dans les compartiments */
.slot-content {
  display: flex;
  width: 100%;
  height: 100%;
  box-sizing: border-box;
}

.slot-content.tl { align-items: flex-start; justify-content: flex-start; padding: var(--pad-sm); }
.slot-content.tr { align-items: flex-start; justify-content: flex-end; padding: var(--pad-sm); }
.slot-content.bl { align-items: flex-end; justify-content: flex-start; padding: var(--pad-sm); }
.slot-content.br { align-items: flex-end; justify-content: flex-end; padding: var(--pad-sm); }

/* ==========================================================================
   CARTES
   ========================================================================== */
.card {
  background: var(--card-bg);
  box-shadow: 0 6px 16px var(--card-shadow);
  border-radius: var(--radius);
  border: 1px solid var(--border);
  padding: 1rem;
  transition: background 0.3s, color 0.3s;
}

/* Carte avec bordure gauche */
.line-card {
  padding: var(--pad-md) var(--pad-md);
  border-left: 4px solid var(--blue);
  display: flex;
  flex-direction: column;
  transition: transform 160ms ease, box-shadow 160ms ease, filter 120ms ease;
}

/* Effets hover par défaut */
.line-card:hover,
.line-card:focus-visible {
  transform: translateZ(0) scale(1.02);
  box-shadow: 0 8px 22px var(--card-shadow);
}

.line-card:active {
  transform: translateZ(0) scale(0.98);
}

/* Désactiver hover pour formulaire de contact */
.contact-form.card.line-card:hover,
.contact-form.card.line-card:focus-visible {
  transform: none !important;
  box-shadow: none !important;
}

/* Contenu des cartes */
.card .info {
  display: flex;
  flex-direction: column;
}

.card .name {
  font-weight: 600;
  color: var(--text);
}

/* Petite carte pour compétences */
.small-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--pad-xxs);
  /* la carte s'adapte uniquement via des clamp : padding et max-width */
  padding: clamp(4px, 1.6vw, 12px);
  width: 100%;
  /* limite la taille générale de la card tout en restant responsive */
  max-width: clamp(90px, 12vw, 140px);
  height: auto;
  box-sizing: border-box;
  overflow: hidden;
  cursor: pointer;
  transform: translateY(0);
  transition: transform 160ms ease, box-shadow 160ms ease;
}

.small-card.visible {
  transform: translateY(0);
  opacity: 1;
}

/* ==========================================================================
   NAVBAR
   ========================================================================== */
.navbar {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: var(--navbar-height);
  min-height: var(--navbar-height);
  box-sizing: border-box; /* empêche les enfants d'agrandir la barre */
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--pad-md);
  padding: 0 var(--pad-md);
  background: var(--page-bg);
  border-bottom: 1px solid var(--border);
  z-index: 3000;
}

.nav-left, .nav-right {
  display: flex;
  align-items: center;
  gap: var(--pad-sm);
}

/* Ne pas laisser des marges/paddings internes des boutons augmenter la hauteur */
.nav-left > button,
.nav-left .burger,
.nav-right > button {
  margin: 0;
  padding: 0;
  line-height: 1;
}

/* Liens de navigation */
.nav-links {
  display: flex;
  gap: var(--pad-sm);
  list-style: none;
  margin: 0;
  padding: 0;
  align-items: center;
  overflow-x: auto;
}

.nav-links::-webkit-scrollbar {
  display: none;
}

.nav-links li {
  cursor: pointer;
  padding: var(--pad-xs) var(--pad-xs);
  border-radius: var(--radius);
  color: var(--text);
  font-weight: 500;
  white-space: nowrap;
  transition: color 0.18s, background 0.18s, transform 0.12s;
}

.nav-links li:hover {
  color: var(--blue);
  transform: translateY(-2px);
}

.nav-links li.active {
  color: var(--blue);
  font-weight: 700;
  box-shadow: inset 0 -2px 0 0 var(--blue);
}

/* Flèches de navigation */
.nav-arrows-container {
  display: flex;
  align-items: center;
  min-width: 0;
}

.nav-arrow {
  background: transparent;
  border: none;
  color: var(--text);
  font-size: var(--fs-body);
  width: 16px;
  height: 16px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: color 0.18s, background 0.18s;
  z-index: 1;
  outline: none;
}

.nav-arrow:active {
  color: var(--blue);
  background: rgba(11,111,184,0.08);
}

/* Actions droite */
.nav-actions {
  display: flex;
  gap: var(--pad-sm);
  align-items: center;
}

/* Sélecteur de langue */
.lang-switcher {
  display: flex;
  gap: var(--pad-sm);
  align-items: center;
}

.lang-switcher img {
  width: 28px;
  height: 20px;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  opacity: 0.55;
  cursor: pointer;
  transition: transform 0.15s, opacity 0.15s;
}

.lang-switcher img.active {
  opacity: 1;
  transform: scale(1.08);
  border: 2px solid var(--blue);
}

/* Bouton thème */
.theme-toggle {
  background: none;
  border: none;
  font-size: var(--fs-h3);
  cursor: pointer;
  padding: var(--pad-xs);
  border-radius: var(--radius);
  color: var(--text);
  display: flex;
  align-items: center;
  height: var(--navbar-height);
}

.theme-toggle:hover {
  filter: brightness(1.05);
}

/* Burger (mobile) */
.burger {
  display: none;
  background: none;
  border: none;
  min-width: var(--navbar-height);
  height: var(--navbar-height);
  padding: 0 var(--pad-xs);
  align-items: center;
  justify-content: center;
  cursor: pointer;
  border-radius: var(--radius);
  color: var(--text);
}
.burger-box {
  display: inline-block;
  width: 22px;
  height: 16px;
  position: relative;
}
.burger-inner,
.burger-inner::before,
.burger-inner::after {
  display: block;
  background: var(--text);
  height: 2px;
  border-radius: 2px;
  transition: transform 200ms ease, opacity 200ms ease;
  position: absolute;
  left: 0;
  right: 0;
}
.burger-inner { top: 50%; transform: translateY(-50%); }
.burger-inner::before { content: ""; top: -6px; }
.burger-inner::after { content: ""; top: 6px; }
.burger-inner.open { transform: rotate(45deg); }
.burger-inner.open::before { transform: rotate(-90deg) translateX(-6px); top: 0; }
.burger-inner.open::after { opacity: 0; }

/* ==========================================================================
   TIMELINE
   ========================================================================== */
.timeline-viewport {
  position: relative;
  width: 100%;
  height: calc(100vh - var(--navbar-height));
  overflow: hidden;
  background: linear-gradient(90deg, var(--bar-fill));
  border-bottom: none;
}

.timeline {
  position: relative;
  padding-left: 68px;
  padding-right: var(--pad-md);
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

/* Ligne verticale */
.timeline::before {
  content: "";
  position: absolute;
  left: 34px;
  top: 8px;
  bottom: 8px;
  width: 4px;
  background: linear-gradient(180deg, var(--blue), rgba(96, 165, 250, 0.55));
  border-radius: var(--radius);
}

/* Éléments timeline */
.timeline-item {
  position: relative;
  margin-bottom: 28px;
  display: flex;
  align-items: flex-start;
  gap: var(--pad-lg);
  opacity: 0;
  transform: translateY(18px) scale(0.99);
  transition: all 520ms cubic-bezier(0.2, 0.9, 0.2, 1);
}

.timeline-item.is-visible {
  opacity: 1;
  transform: translateY(0) scale(1);
}

/* Points sur timeline */
.dot {
  position: absolute;
  left: 0;
  width: 68px;
  height: 68px;
  border-radius: 50%;
  background: var(--card-bg);
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 6px 18px var(--card-shadow);
  border: 2px solid var(--border);
  flex-shrink: 0;
}

/* Métadonnées */
.meta {
  display: flex;
  gap: var(--pad-md);
  align-items: baseline;
  flex-wrap: wrap;
}

.year {
  font-weight: 700;
  color: var(--blue);
  font-size: var(--fs-body);
}

.institution {
  font-size: var(--fs-body);
  color: var(--text-secondary);
}

.degree {
  margin-bottom: 6px;
  font-size: var(--fs-body);
  font-weight: 700;
  color: var(--text);
  line-height: 1.25;
}

/* Catégories */
.category {
  margin-bottom: 56px;
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.category:last-child {
  margin-bottom: 0;
}

.category-header {
  display: flex;
  justify-content: space-between;
  margin-bottom: var(--pad-xxs);
  margin-bottom: 20px;
}

.category-header h3 {
  font-size: var(--fs-h3);
  color: var(--text);
}

.category-header .years {
  font-size: var(--fs-body);
  color: var(--text-secondary);
}

/* Grille */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: var(--pad-lg);
  flex: 1;
  min-height: 0;
}

/* Détails */
.dates {
  font-size: var(--fs-small);
  font-weight: 600;
  color: var(--blue);
  margin-bottom: 4px;
}

.company {
  font-weight: 600;
  font-size: var(--fs-body);
  margin-bottom: var(--pad-xxs);
  color: var(--text);
}

.role {
  font-size: var(--fs-body);
  font-weight: 500;
  margin-bottom: 6px;
  color: var(--text-secondary);
}

.details {
  font-size: var(--fs-small);
  color: var(--text-secondary);
  margin: 0;
  padding-left: var(--pad-md);
  flex: 1;
}

/* ==========================================================================
   OVERLAY TIMELINE
   ========================================================================== */
.timeline-overlay {
  position: absolute;
  inset: 0;
  pointer-events: none;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  gap: 2.2vh;
  padding: 10vh 6vw 4vh 6vw;
  opacity: 0.74;
}

.timeline-overlay .overlay-item {
  line-height: 1.1;
  text-shadow: 0 2px 6px rgba(0,0,0,0.25);
}

.timeline-overlay .overlay-type {
  font-size: clamp(0.9rem, 1.1vw, 1rem);
  font-weight: 600;
  letter-spacing: 0.02em;
  color: var(--text);
}

.timeline-overlay .overlay-info {
  font-size: clamp(1rem, 1.3vw, 1.125rem);
  font-weight: 800;
  color: var(--text);
}

.timeline-overlay .overlay-level {
  font-size: clamp(1rem, 1vw, 1.1rem);
  font-weight: 500;
  color: var(--text-secondary);
}

/* Éléments overlay */
.overlay-item {
  position: relative;
  display: flex;
  align-items: center;
  min-height: 45px;
  max-width: 620px;
  background: rgba(30,30,30,0.85);
  border-radius: var(--radius);
  box-shadow: 0 2px 12px rgba(0,0,0,0.12);
  overflow: hidden;
  font-size: var(--fs-body);
  color: #fff;
  border-left: 12px solid var(--line-color, #53bc28);
}

/* Couleurs par catégorie */
.overlay-item.formation { --line-color: var(--formation-color); }
.overlay-item.stage { --line-color: var(--stage-color); }
.overlay-item.travail { --line-color: var(--travail-color); }
.overlay-item.autre { --line-color: var(--autre-color); }

.section, .page-layout, .page, .wrapper {
  box-sizing: border-box;
  max-width: 100vw;
  overflow-x: hidden;
}

.overlay-type, .overlay-info, .overlay-level {
  padding-left: var(--pad-md);
  padding-right: var(--pad-md);
  text-shadow: 0 0 8px rgba(0,0,0,0.18);
}

.overlay-type {
  font-weight: 700;
  font-size: 0.97rem;
  margin-bottom: var(--pad-xxs);
  letter-spacing: 0.01em;
}

.overlay-info {
  font-size: 0.97rem;
  margin-bottom: var(--pad-xxs);
}

.overlay-level {
  font-size: 0.85rem;
  color: #ffe;
  margin-top: var(--pad-xxs);
}

/* Milestones */
.milestone {
  position: absolute;
  bottom: 28px;
  transform: translateX(-50%);
  display: flex;
  align-items: center;
  gap: var(--pad-sm);
  pointer-events: none;
}

.milestone .dot {
  display: none !important;
  width: 0;
  height: 0;
  border: 0;
}

.milestone .label {
  font-size: var(--fs-small);
  color: var(--text);
  text-shadow: 0 1px 2px rgba(0,0,0,0.35);
}

/* Couleurs par catégorie */
.milestone.cat-formation .dot { border-color: var(--cat-formation); }
.milestone.cat-formation .label { color: var(--cat-formation); }

.milestone.cat-stage .dot { border-color: var(--cat-stage); }
.milestone.cat-stage .label { color: var(--cat-stage); }

.milestone.cat-travail .dot { border-color: var(--cat-travail); }
.milestone.cat-travail .label { color: var(--cat-travail); }

.milestone.cat-autre .dot { border-color: var(--cat-autre); }
.milestone.cat-autre .label { color: var(--cat-autre); }

/* ==========================================================================
   COMPÉTENCES ET LOGOS
   ========================================================================== */
/* Logos de diplômes */
.degree-thumb {
  border-radius: var(--radius);
  overflow: visible;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.degree-thumb img {
  display: block;
  width: clamp(45px, 10vw, var(--degree-thumb-width, 120px)) !important;
  object-fit: contain;
  object-position: center;
  filter: drop-shadow(0 0 1px rgba(11,111,184,0.6));
}

/* Hover sur logos */
.company-logo-link:hover .degree-thumb img,
.degree-thumb:hover img {
  transform: translateZ(0) scale(1.04);
  filter: drop-shadow(0 0 1px rgba(11,111,184,0.65)) brightness(1.01) contrast(1.01);
}

.company-logo-link:active .degree-thumb img,
.degree-thumb:active img {
  transform: translateZ(0) scale(0.98);
}

.company-logo-link {
  cursor: pointer;
  display: inline-block;
}

.company-link {
  cursor: pointer;
}

/* Logos SVG avec effet glow */
.logo {
  width: 80px;
  height: 80px;
  margin: var(--pad-xs) auto;
  flex-shrink: 0;
  filter: drop-shadow(0 0 2px var(--blue));
  opacity: 0.75;
  stroke-dashoffset: 2000px;
  stroke-dasharray: 2000px;
  animation: animateLogo 10s linear forwards;
}

@keyframes animateLogo {
  to {
    stroke-dashoffset: 0;
  }
}

.logo :deep(svg) {
  width: 100%;
  height: 100%;
  filter: url(#glow);
  opacity: 1;
}

.small-card.visible .logo {
  opacity: 1;
}

.small-card:hover .logo :deep(svg) {
  filter: url(#glow-green);
  transform: scale(1.05);
}

.small-card:hover .logo {
  opacity: 1;
  transform: scale(1.05);
  filter: drop-shadow(0 0 2px var(--green-glow));
}

.small-card:active .logo {
  transform: scale(0.95);
}

.small-card:not(.is-clicked):hover .logo :deep(svg) {
  filter: url(#glow-green);
}

/* Info sous logos */
.info {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: var(--pad-xxs);
}

/* Ensure .info spans the full card width on skills page so bar percentages
   are calculated relative to the card and not to a narrower container. */
.skills-page .small-card .info {
  width: 100% !important;
  box-sizing: border-box;
  align-items: center;
}

.name {
  font-size: var(--fs-small);
  font-weight: 600;
  color: var(--text);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
}

.level {
  font-size: var(--fs-small);
  color: var(--text-secondary);
}

/* Responsive: réduire les logos, le nom et le level spécifiquement sur la page Hard_Skills
   Utilise clamp() pour s'adapter fluidemnt sans impacter les autres pages */
.skills-page .small-card .logo {
  /* mini 48px, idéal autour de 8vw, max 80px (valeur actuelle) */
  width: clamp(45px, 8vw, 80px);
  height: clamp(45px, 8vw, 80px);
}

.skills-page .small-card .name {
  /* texte légèrement plus petit sur mobile, max proche de la taille actuelle */
  font-size: clamp(0.75rem, 1.5vw, 0.95rem);
}

.skills-page .small-card .level {
  /* plus lisible et proportionnel à la taille écran */
  font-size: clamp(0.65rem, 1.2vw, 0.85rem);
}

/* Barre de progression (scopée à la page skills pour éviter les overrides) */
.skills-page .small-card .bar {
  background: var(--bar-bg);
  border-radius: var(--radius);
  overflow: hidden;
  /* épaisseur fixe (toujours 6px) */
  height: 7px !important;
  /* espacement vertical adapté */
  margin: clamp(6px, 1.2vw, 12px) 0;
  /* largeur proportionnelle à la card : min 48px, idéal 60% du conteneur, max 140px */
  width: clamp(48px, 60%, 140px);
  flex-shrink: 0;
}

.skills-page .small-card .fill {
  height: 100%;
  background: var(--bar-fill);
  border-radius: inherit;
}

/* Filtres SVG */
.filters {
  position: absolute;
  width: 0;
  height: 0;
}

#glow, #glow-hover {
  --glow-color: var(--blue);
}

#glow {
  --blur-radius: 4px;
  --opacity: 0.5;
}

#glow-hover {
  --blur-radius: 8px;
  --opacity: 0.8;
}

/* ==========================================================================
   QR CODES ET FAVICON
   ========================================================================== */
/* QR dans le coin des cartes */
.card.corner {
  position: relative;
  /* espace réservé pour le QR à droite (taille QR + marge droite + petit padding) */
  padding-inline-end: calc(var(--corner-qr-size) + var(--corner-qr-margin-right) + var(--pad-sm));
  /* hauteur minimale = taille QR + marge verticale (top/bottom) + espace pour contenu */
  min-height: calc(var(--corner-qr-size) + var(--corner-qr-margin-top) + 4em);
}

.card.corner .corner-qr {
  position: absolute;
  right: var(--corner-qr-margin-right);
  bottom: var(--corner-qr-margin-top);
  width: var(--corner-qr-size);
  height: var(--corner-qr-size);
  border-radius: var(--radius);
  overflow: hidden;
  box-shadow: 0 6px 18px var(--card-shadow);
  transform-origin: center bottom;
  transition: transform 180ms cubic-bezier(.2,.9,.2,1), box-shadow 160ms ease, filter 120ms ease;
  cursor: pointer;
}

.card.corner .corner-qr img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  transition: transform 160ms ease, filter 120ms ease;
}

/* Hover QR */
.card.corner .corner-qr:hover,
.card.corner .corner-qr:focus {
  transform: scale(1.08);
  box-shadow: 0 12px 30px rgba(0,0,0,0.12);
}

.card.corner .corner-qr:active {
  transform: scale(0.98);
}

.card.corner .corner-qr:focus {
  outline: 2px solid rgba(11,111,184,0.12);
}

/* Bloc QR (regroupe QR + légende) */
.card.corner .corner-qr-block {
  position: absolute;
  width: var(--corner-qr-size);
  text-align: center;
  box-sizing: border-box;
}

.card.corner .corner-qr-block .corner-qr {
  position: static;
  width: 100%;
  height: var(--corner-qr-size);
}

/* Légende QR */
.corner .qr-caption {
  margin-top: 8px;
  text-align: center;
}

.corner .qr-caption .qr-name {
  font-weight: 700;
  color: var(--text);
}

.corner .qr-caption .qr-short {
  font-size: var(--fs-small);
  color: var(--text-secondary);
}

/* Favicon centré cliquable */
.links-wrapper {
  position: relative;
}

.links-wrapper .favicon-center {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: none;
  z-index: 2999;
}

.links-wrapper .favicon-center img {
  width: var(--favicon-size);
  height: auto;
  display: block;
  margin: 0 auto;
}

.links-wrapper .clickable-favicon {
  pointer-events: auto;
  cursor: pointer;
  will-change: transform;
  outline: none;
  position: relative;
  z-index: 3000;
  transition: transform 160ms ease, filter 120ms ease;
}

.links-wrapper .clickable-favicon:hover {
  transform: translateZ(0) scale(1.05);
  filter: brightness(1.02) drop-shadow(0 0 16px color-mix(in hsl, var(--blue), transparent 78%));
}

.links-wrapper .clickable-favicon:active {
  transform: translateZ(0) scale(0.98);
}

.links-wrapper .clickable-favicon:focus-visible {
  filter: drop-shadow(0 0 16px color-mix(in hsl, var(--blue), transparent 78%));
}

/* ==========================================================================
   YEARSTREAM (FLUX D'ANNÉES)
   ========================================================================== */
.yearstream {
  position: absolute;
  left: 0;
  right: 0;
  bottom: var(--ys-bottom-offset, -20px);
  width: 100%;
  height: 140px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.ys-card-stream {
  position: absolute;
  width: 100%;
  height: 120px;
  display: flex;
  align-items: center;
  overflow: visible;
}

.ys-card-line {
  position: relative;
  height: 100px;
  white-space: nowrap;
  cursor: grab;
  user-select: none;
  will-change: transform;
  direction: ltr;
}

.ys-card-line.dragging {
  cursor: grabbing;
}

.ys-card-wrapper {
  position: absolute;
  width: 160px;
  height: 100px;
}

.ys-card {
  position: absolute;
  top: 0;
  left: 0;
  width: 160px;
  height: 100px;
  border-radius: 10px;
  overflow: hidden;
}

/* Carte normale */
.ys-card-normal {
  background: transparent;
  box-shadow: 0 10px 28px rgba(0,0,0,0.38);
  z-index: 2;
  position: relative;
  overflow: hidden;
}

.ys-card-gradient {
  position: absolute;
  inset: 0;
  display: none;
}

.ys-card-year {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  font-size: 32px;
  font-weight: 900;
  color: var(--text);
  text-shadow: 0 2px 8px rgba(0,0,0,0.25);
}

.ys-year-text {
  display: inline-block;
}

.ys-year-text.rtl-text {
  direction: rtl;
  unicode-bidi: plaintext;
  text-align: right;
}

/* Overlay ASCII */
.ys-card-ascii {
  background: transparent;
  z-index: 1;
  position: absolute;
  top: 0;
  left: 0;
  width: 160px;
  height: 100px;
  border-radius: 10px;
  overflow: hidden;
}

.ys-ascii-content {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  color: color-mix(in hsl, var(--text), transparent 40%);
  font-family: 'Courier New', monospace;
  overflow: hidden;
  white-space: pre;
  animation: ys-glitch 0.1s infinite linear alternate-reverse;
  margin: 0;
  padding: 0;
  text-align: left;
  vertical-align: top;
  box-sizing: border-box;
}

@keyframes ys-glitch {
  0% { opacity: 1; }
  15% { opacity: 0.9; }
  16% { opacity: 1; }
  49% { opacity: 0.8; }
  50% { opacity: 1; }
  99% { opacity: 0.9; }
  100% { opacity: 1; }
}

/* Clip properties */
.ys-card-normal {
  clip-path: inset(0 0 0 var(--clip-right, 0%));
}

.ys-card-ascii {
  clip-path: inset(0 calc(100% - var(--clip-left, 0%)) 0 0);
}

/* Effet scan */
.ys-scan-effect {
  position: absolute;
  inset: 0;
  background: linear-gradient(90deg, transparent, rgba(0,255,255,0.4), transparent);
  animation: ys-scan 0.6s ease-out;
  pointer-events: none;
  z-index: 5;
}

@keyframes ys-scan {
  0% { transform: translateX(-100%); opacity: 0; }
  50% { opacity: 1; }
  100% { transform: translateX(100%); opacity: 0; }
}

/* Canvases */
.ys-particles {
  position: absolute;
  top: 50%;
  left: 0;
  transform: translateY(-50%);
  width: 100%;
  height: 80px;
  z-index: 0;
  pointer-events: none;
}

.ys-scanner {
  position: absolute;
  top: 50%;
  left: 0;
  transform: translateY(-50%);
  width: 100%;
  height: 60px;
  z-index: 15;
  pointer-events: none;
}

/* ==========================================================================
   POPUPS
   ========================================================================== */
.popup-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 5000;
}

.popup-content {
  background: var(--card-bg);
  border-radius: var(--radius);
  padding: var(--pad-md);
  position: relative;
  width: 520px;
  max-width: 90%;
  box-shadow: 0 6px 20px var(--card-shadow);
  animation: fadeIn 0.3s ease;
  color: var(--text);
  border: 1px solid var(--border);
}

.popup-content.popup-large {
  width: 900px;
  max-width: 95%;
}

@keyframes fadeIn {
  from { opacity: 0; transform: scale(0.9); }
  to { opacity: 1; transform: scale(1); }
}

.close-btn {
  position: absolute;
  top: 8px;
  right: 16px;
  background: var(--card-bg);
  color: var(--text);
  border: none;
  width: 36px;
  height: 36px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: var(--radius);
  font-size: var(--fs-body);
  line-height: 1;
  cursor: pointer;
  box-shadow: 0 4px 10px var(--card-shadow);
  transition: transform 120ms ease;
}

.close-btn:hover {
  transform: scale(1.08);
}

.close-btn:active {
  transform: scale(0.9);
}

.popup-body {
  font-size: var(--fs-body);
  color: var(--text-secondary);
}

.popup-link {
  display: inline-block;
  margin-top: var(--pad-sm);
  color: var(--blue);
  font-weight: 600;
  text-decoration: none;
}

.popup-link:hover {
  text-decoration: underline;
}

.popup-image {
  max-width: 100%;
}

/* Zoom images diplômes */
.zoom-wrapper {
  position: relative;
  display: inline-block;
  max-width: 100%;
  overflow: hidden;
}

.pan-wrapper {
  display: block;
  touch-action: none;
  cursor: grab;
}

.pan-wrapper.dragging {
  cursor: grabbing;
}

.zoom-wrapper .popup-image {
  transition: transform 320ms cubic-bezier(.2,.8,.2,1);
  transform-origin: center center;
  display: block;
  margin: 0 auto;
  max-width: 100%;
  max-height: 80vh;
}

.zoom-control {
  display: flex;
  align-items: center;
  gap: var(--pad-xs);
}

.zoom-control input[type="range"] {
  width: 220px;
}

.zoom-value {
  font-weight: 600;
  padding-left: var(--pad-xs);
}

.zoom-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: var(--text);
  opacity: 0.7;
  margin-right: var(--pad-xs);
}

.zoom-icon svg {
  display: block;
}

.diploma-name {
  font-weight: 700;
  max-width: 360px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  text-align: center;
}

/* Spinner overlay */
.popup-spinner-overlay {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(0,0,0,0);
  pointer-events: none;
  font-weight: 700;
  color: var(--text);
}

/* ==========================================================================
   CONTACT FORM
   ========================================================================== */
.contact-form label {
  display: block;
  margin: 1.5rem 0;
  font-weight: 700;
  color: var(--text);
}

.contact-form input,
.contact-form textarea {
  width: 100%;
  padding: 0.6rem .75rem;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  background: transparent;
  color: var(--text);
  box-sizing: border-box;
  font-size: var(--fs-body);
}

.contact-form textarea {
  min-height: 250px;
  resize: vertical;
}

.contact-form .actions {
  margin-top: 1.8rem;
  display: flex;
  justify-content: flex-end;
  gap: var(--pad-md);
}

.contact-form .actions button {
  padding: .5rem 1rem;
}

.contact-form p.ok {
  color: var(--green-glow);
}

.contact-form p.error {
  color: crimson;
}

/* Bouton trombone */
.clip-btn {
  background: transparent;
  border: none !important;
  padding: var(--pad-xs);
  cursor: pointer;
  color: var(--blue);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  box-shadow: none;
  transition: transform .16s cubic-bezier(.2,.9,.2,1), filter .12s ease, opacity .12s ease;
  transform-origin: center center;
}

.clip-btn:focus {
  outline: none;
}

.clip-btn:hover {
  transform: scale(1.12);
  filter: brightness(0.98);
}

.clip-btn:active {
  transform: scale(1.06);
}

.clip-btn:disabled {
  opacity: 0.45;
  cursor: not-allowed;
  transform: none;
  filter: grayscale(0.2);
}

.clip-icon {
  width: 24px;
  height: 24px;
  display: block;
  color: var(--blue);
}

/* Liste pièces jointes */
.contact-form .attachments-list {
  margin: 1rem 0 0.6rem 0;
  display: flex;
  flex-direction: column;
  gap: var(--pad-xs);
}

.contact-form .attachment-item {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: var(--pad-sm);
  padding: 0;
  border: none;
  background: transparent;
}

.contact-form .attachment-name {
  color: var(--text);
  font-size: var(--fs-body);
  word-break: break-all;
}

.contact-form .attachment-size {
  color: var(--text-secondary);
  font-size: var(--fs-small);
}

.contact-form .attachment-remove {
  background: transparent;
  border: none;
  color: crimson;
  font-size: 18px;
  line-height: 1;
  cursor: pointer;
  padding: 0 var(--pad-xs);
  margin-left: auto;
}

.contact-form .attachment-remove:hover {
  filter: brightness(1.05);
}

.contact-form .attachment-remove:active {
  transform: scale(0.96);
}

.contact-form .attachment-warning {
  margin-top: 4px;
  color: crimson;
  font-size: var(--fs-small);
}

/* ==========================================================================
   BOUTONS ET LIENS
   ========================================================================== */
button {
  border-radius: var(--radius);
  border: 1px solid transparent;
  padding: 0.6em 1.2em;
  font-size: var(--fs-body);
  font-weight: 500;
  background-color: var(--blue);
  color: #fff;
  cursor: pointer;
  transition: 0.25s;
}

button:hover {
  filter: brightness(1.05);
}

a {
  color: var(--blue);
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

/* Bouton carte (role=button) */
.card[role="button"] {
  cursor: pointer;
}

/* ==========================================================================
   BOUTON TELEGRAM
   ========================================================================== */
.tg-send {
  width: var(--tg-size);
  height: var(--tg-size);
  padding: 0;
  border: none !important;
  background: transparent;
  color: var(--blue);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: none;
  transition: transform 160ms cubic-bezier(.2,.9,.2,1), filter 120ms ease, opacity 120ms ease;
  transform-origin: center center;
  transform: var(--tg-flip) scale(var(--tg-scale));
}

.tg-send:focus {
  outline: none;
}

.tg-send:hover {
  --tg-scale: 1.12;
  filter: brightness(0.98);
}

.tg-send:active {
  --tg-scale: 1.06;
}

.tg-send:disabled {
  opacity: 0.45;
  cursor: not-allowed;
  --tg-scale: 1;
  filter: grayscale(0.2);
}

.tg-send .tg-icon {
  display: block;
  color: var(--blue);
  width: 34px;
  height: 34px;
  transform: translateX(var(--tg-icon-offset));
}

/* RTL pour bouton Telegram */
.contact-form[dir="rtl"] .tg-send {
  --tg-flip: scaleX(-1);
  --tg-icon-offset: -8px;
}

/* ==========================================================================
   PROJETS ET IFRAMES
   ========================================================================== */
.projects-grid {
  grid-template-columns: repeat(auto-fit, minmax(300px, 500px));
  width: 100%;
}

.preview-link {
  display: block;
  width: 100%;
  aspect-ratio: 16/11;
  border-radius: var(--radius);
  margin: var(--pad-sm) 0;
  overflow: hidden;
  position: relative;
}

.preview-link:hover {
  transform: scale(1.05);
  box-shadow: 0 8px 20px var(--card-shadow);
}

.preview-link:active {
  transform: scale(0.95);
}

.iframe-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: relative;
}

.project-iframe {
  width: 400%;
  height: 400%;
  border: none;
  pointer-events: none;
  transform: scale(0.25);
  transform-origin: top left;
}

/* ==========================================================================
   UTILITAIRES
   ========================================================================== */
.reveal {
  opacity: 1;
  transform: translateY(18px) scale(0.99);
  transition: all 520ms cubic-bezier(0.2, 0.9, 0.2, 1);
}

.reveal.is-visible {
  opacity: 1;
  transform: translateY(0) scale(1);
}

.name-banner {
  position: fixed;
  top: calc(var(--navbar-height) + var(--fs-small));
  left: 0;
  right: 0;
  height: var(--name-banner-height);
  pointer-events: none;
  z-index: 2500;
}

.name-banner .svg-holder {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.name-banner .fade-out {
  opacity: 0;
  transition: opacity 0.6s ease;
}

.name-banner svg {
  width: 100%;
  height: 100%;
  display: block;
  color: var(--text);
}

.cv-tooltip {
  position: fixed;
  background: rgba(0, 0, 0, 0.85);
  color: #fff;
  padding: var(--pad-xs) var(--pad-xs);
  border-radius: var(--radius);
  font-size: 13px;
  pointer-events: none;
  z-index: 10000;
  white-space: nowrap;
  transform: translate(0, 0);
}

.clickable-favicon {
  cursor: pointer;
}

/* ==========================================================================
   STYLES SPÉCIFIQUES PAGES
   ========================================================================== */
/* Page Diplômes */
.diplomas-page .degree-thumb {
  width: clamp(45px, 10vw, var(--degree-thumb-width, 120px)) !important;
  height: auto;
}

.diplomas-page .degree-thumb img {
  width: 100%;
  height: auto;
  object-fit: contain;
}

.diplomas-page .timeline-item,
.diplomas-page .degree-thumb,
.diplomas-page .line-card {
  position: relative;
  z-index: 3000;
}

.diplomas-page .timeline {
  padding-left: 0;
}

.diplomas-page .timeline::before {
  display: none;
}

.diplomas-page .line-card {
  border-left: none;
}

/* Page Compétences */
.skills-page .skills-grid {
  display: grid;
  /* une seule règle responsive pour la taille des cards (min, idéal, max) */
  grid-template-columns: repeat(auto-fill, minmax(clamp(90px, 12vw, 180px), 1fr));
  /* gap uniforme horizontal + vertical, responsive */
  gap: clamp(8px, 2vw, 24px);
  /* padding géré par le gap pour garantir marges égales */
  /* padding: 0;
  margin: 0; */
}

/* Forcer les règles de la page skills (évite les overrides depuis d'autres media queries)
   Nous utilisons !important pour garantir une seule règle responsive homogène */
.skills-page .small-card {
  width: 100% !important;
  max-width: clamp(90px, 12vw, 140px) !important;
  padding: clamp(4px, 1.6vw, 12px) !important;
}

.skills-page .small-card .logo {
  width: clamp(45px, 8vw, 80px) !important;
  height: clamp(45px, 8vw, 80px) !important;
}

.skills-page .small-card .name {
  font-size: clamp(0.75rem, 1.5vw, 0.95rem) !important;
}

.skills-page .small-card .bar {
  /* Width scales with the card: min 56px, ideal 72% of card, max 160px */
  width: clamp(50px, 80%, 200px) !important;
  height: 7px !important;
  display: block;
}

.skills-page .small-card .fill {
  transition: width 360ms cubic-bezier(.2,.9,.2,1);
}

/* Page Liens */
.links-wrapper .card.line-card.corner {
  width: calc(var(--corner-qr-size) + var(--corner-qr-margin-left) + var(--corner-qr-margin-right));
  min-width: calc(var(--corner-qr-size) + var(--corner-qr-margin-left) + var(--corner-qr-margin-right));
  max-width: calc(var(--corner-qr-size) + var(--corner-qr-margin-left) + var(--corner-qr-margin-right));
  min-height: calc(var(--corner-qr-size) + var(--corner-qr-margin-top) + 6em);
  box-sizing: border-box;
}

.links-wrapper .corner-qr,
.links-wrapper .corner-qr img {
  border-radius: var(--radius);
}

.links-wrapper .corner-qr-block {
  margin-bottom: 0;
  margin-top: 0;
  padding-bottom: 0;
  padding-top: 0;
}


/* ==========================================================================
   RESPONSIVE DESIGN
   ========================================================================== */
/* Variables responsive pour QR codes */
/* La sous-section ne doit jamais être plus petite que la card corner */
.sub-section {
  min-width: calc(var(--corner-qr-size) + var(--corner-qr-margin-left) + var(--corner-qr-margin-right));
}

/* -------------------------------
   POINT DE RUPTURE: 1024px (Tablettes)
   ------------------------------- */
@media (max-width: 1024px) {
  :root {
    --corner-qr-size: clamp(120px, 10vw, 220px);
    --corner-qr-margin: clamp(14px, 1.5vw, 24px);
  }

  .links-wrapper .line-card h3,
  .links-wrapper .line-card small {
    display: none;
  }

  .links-wrapper .page-layout.grid-2x2 {
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr 1fr;
  }
  .soft-skills-page .page-layout.grid-2x2 {
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr 1fr;
  }
  
  .projects-grid {
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  }
  
  .dot {
    width: 60px;
    height: 60px;
  }
  
  .project-iframe {
    transform: scale(0.25);
    transform-origin: top left;
  }
}

/* Desktop uniquement pour coins QR */
@media (min-width: 1025px) {
  .links-wrapper .card.line-card.corner {
    width: calc(var(--corner-qr-size) + var(--corner-qr-margin-left) + var(--corner-qr-margin-right));
    min-width: calc(var(--corner-qr-size) + var(--corner-qr-margin-left) + var(--corner-qr-margin-right));
    max-width: calc(var(--corner-qr-size) + var(--corner-qr-margin-left) + var(--corner-qr-margin-right));
    box-sizing: border-box;
  }
}

/* -------------------------------
   POINT DE RUPTURE: 768px (Mobiles)
   ------------------------------- */
@media (max-width: 768px) {
  :root {
    --corner-qr-size: clamp(90px, 8vw, 160px);
    --corner-qr-margin: clamp(8px, 1vw, 14px);
    /* Garder la taille du texte responsive sur petits écrans
       au lieu de forcer 1rem (qui empêchait le rétrécissement/agrandissement)
       On utilise clamp(min, vw-based, max) pour rester fluide. */
    /* --fs-body: clamp(0.85rem, 3.2vw, 1.05rem); */
  }

  button { 
    font-size: var(--fs-body);
  }

  .links-wrapper {
    /* Valeurs encore plus petites pour écrans étroits */
    --corner-qr-margin: clamp(2px, 1vw, 6px);
    --corner-qr-margin-top: clamp(1px, 0.8vw, 4px);
    --corner-qr-margin-left: clamp(1px, 0.8vw, 3px);
    --corner-qr-margin-right: clamp(1px, 0.8vw, 3px);
  }

  .links-wrapper .page-layout.grid-2x2 {
    grid-template-columns: 1fr 1fr !important;
    grid-template-rows: 1fr 1fr !important;
  }

  /* Make Soft_Skills page layout behave like Links page on small screens */
  .soft-skills-page .page-layout.grid-2x2 {
    grid-template-columns: 1fr 1fr !important;
    grid-template-rows: 1fr 1fr !important;
  }

  .soft-skills-page .card {
    max-height: none !important;
    overflow: visible !important;
    /* remove any previous clamping behaviours */
    -webkit-line-clamp: unset;
    line-clamp: unset;
    -webkit-box-orient: unset;
    display: block;
  }

  /* ensure the title and short description stack nicely inside the card */
  .soft-skills-page .card .name,
  .soft-skills-page .card .short {
    display: block;
    margin: 0 0 0.3rem 0;
  }

  .links-wrapper .slot-content,
  .links-wrapper .card,
  .links-wrapper .card.corner,
  .links-wrapper .card.line-card.corner {
    min-width: 0 !important;
    width: 100% !important;
    box-sizing: border-box;
  }

  /* réduire padding/margins si nécessaire pour tenir sur de très petits écrans */
  .links-wrapper .wrapper,
  .links-wrapper .slot-content {
    padding: var(--pad-xs) !important;
  }

  .links-wrapper .page-layout {
    grid-template-columns: 1fr 1fr;
  }
  
  .links-wrapper .page-layout.grid-2x2 {
    grid-template-rows: 1fr 1fr;
  }

  .soft-skills-page .page-layout {
    grid-template-columns: 1fr 1fr;
  }

  .soft-skills-page .page-layout.grid-2x2 {
    grid-template-rows: 1fr 1fr;
  }
  
  .links-wrapper .wrapper {
    padding: var(--pad-md) var(--pad-sm);
  }
  
  .page-layout {
    grid-template-columns: 1fr;
    /* allow rows to size to their content on small screens so cards can grow */
    grid-auto-rows: auto;
    align-items: stretch;
    row-gap: var(--sub-gap);
  }
  
  .page-layout.grid-2x2 {
    grid-template-rows: unset;
  }
  
  .sub-section {
    height: 100%;
  }
  
  .sub-section .sub-inner {
    height: 100%;
  }
  
  .grid {
    grid-template-columns: 1fr;
    gap: var(--pad-md);
  }
  
  .projects-grid {
    grid-template-columns: 1fr;
  }

  .nav-links {
    display: flex;
    gap: var(--pad-sm);
    list-style: none;
    margin: 0;
    padding: 0;
    align-items: center;
    overflow-x: auto;
  }

  .timeline {
    padding-left: 50px;
  }

  .timeline::before {
    left: 25px;
  }

  /* Masquer uniquement les flèches, garder le conteneur actif pour les nav-links */
  .nav-arrows-container .nav-arrow {
    display: none; /* utiliser burger sur petit écran */
  }

  /* Rapprocher le burger du theme-toggle et éviter tout changement de hauteur */
  .nav-left { gap: var(--pad-md); }

  /* .burger { display: flex; } */

  /* Garder la taille du navbar inchangée */
  .theme-toggle, .burger {
    height: var(--navbar-height);
    display: flex;
    align-items: center;
  }

  .nav-links {
    position: absolute;
    top: var(--navbar-height);
    left: 0;
    right: 0;
    background: var(--page-bg);
    display: flex;
    flex-direction: column;
    gap: 0;
    /* padding: var(--pad-sm); */
    max-height: 0;
    overflow: hidden;
    transition: max-height 220ms ease, box-shadow 180ms ease;
    border-bottom: 1px solid var(--border);
    z-index: 3100;
  }

  .nav-links.open {
    max-height: 60vh;
    overflow: auto;
  }

  .nav-links li {
    /* padding: calc(var(--pad-xs) + 6px) 0; */
    /* border-bottom: 1px solid rgba(0,0,0,0.04); */
    /* white-space: normal; */
  }

  .nav-links li:hover {
    /* transform: none; */
  }

  /* .lang-switcher {
    gap: calc(var(--pad-sm) / 2);
  } */
  
  .dot {
    width: 50px;
    height: 50px;
  }
  
  .small-card {
    width: 110px;
  }
  
  .logo {
    width: 80px;
    height: 80px;
  }
  
  .skills-page .small-card .bar {
    width: clamp(48px, 50%, 160px);
  }
  
  .popup-content {
    width: 90%;
    padding: var(--pad-md);
  }
  
  .category-header {
    flex-direction: column;
    align-items: flex-start;
    gap: var(--pad-xs);
  }
  
  .preview-link:hover .iframe-container {
    border: 1px solid var(--border);
  }

  .links-wrapper .card {
    min-height: calc((var(--corner-qr-size) * 2.3) + var(--pad-md)) !important;
  }
}

/* -------------------------------
   POINT DE RUPTURE: 600px (Mobile Links)
   ------------------------------- */
@media (max-width: 600px) {
  .links-wrapper {
    max-width: 100vw;
    overflow-x: hidden;
    padding: 0 2vw;
    /* Réduire fortement les marges autour du QR sur petits écrans */
    --corner-qr-margin: clamp(4px, 2.5vw, 8px);
    --corner-qr-margin-top: clamp(2px, 1vw, 6px);
    --corner-qr-margin-left: clamp(2px, 1vw, 4px);
    --corner-qr-margin-right: clamp(2px, 1vw, 4px);
  }
  
  .links-wrapper .page-layout,
  .links-wrapper .page-layout.grid-2x2 {
    /* conserver une grille 2x2 sur petits écrans afin que chaque carte reste
       dans son coin (haut-gauche, haut-droite, bas-gauche, bas-droite) */
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr 1fr;
    /* forcer chaque cellule à occuper l'espace disponible pour que les
       alignements .slot-content.tl/tr/bl/br posent correctement les cartes */
    grid-auto-rows: 1fr;
    height: 100%;
  }
  
  .links-wrapper .slot-content {
    min-width: 0;
    width: 100%;
    box-sizing: border-box;
    padding: var(--pad-xs) 0;
  }
  
  .links-wrapper .card.corner {
    /* Ne pas forcer la card à 100% de largeur sur mobile: garder sa largeur
       relative au QR afin qu'elle reste collée au coin via .slot-content */
    width: auto;
    max-width: calc(var(--corner-qr-size) + var(--corner-qr-margin-left) + var(--corner-qr-margin-right));
    margin: 0;
    /* réduire encore l'espacement vertical à l'intérieur de la card corner sur mobile */
    padding-top: var(--pad-xs);
    padding-bottom: var(--pad-xs);
    box-sizing: border-box;
  }
  
  .links-wrapper .qr-caption {
    margin-top: 8px;
    text-align: center;
  }
  
  .links-wrapper .qr-name {
    color: var(--text);
    margin-bottom: var(--pad-xxs);
  }
  
  .links-wrapper .qr-short {
    color: var(--text-secondary);
  }
  
  .links-wrapper .corner-qr {
    min-width: 64px;
    min-height: 64px;
    width: 80px;
    height: 80px;
  }
  
  /* Alignement cartes Links */
  .links-wrapper .card.line-card.corner {
    overflow: visible;
    padding-bottom: var(--pad-md);
    padding-top: var(--pad-md);
  }
  
  /* Style line-card sur mobile */
  .links-wrapper .line-card {
    margin: 0 auto var(--pad-sm) auto;
    padding: var(--pad-md) var(--pad-md);
    border-left: 4px solid var(--blue);
    border-radius: var(--radius);
    background: var(--card-bg);
    box-shadow: 0 6px 16px var(--card-shadow);
    width: 100%;
    max-width: 100%;
    min-width: 0;
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}

/* -------------------------------
   POINT DE RUPTURE: 480px (Très petits écrans)
   ------------------------------- */
@media (max-width: 480px) {
  :root {
  /* --corner-qr-size: clamp(40px, 6vw, 64px); */
    --corner-qr-margin: clamp(2px, 0.5vw, 8px);
  }

  .section {
    padding: var(--pad-sm);
  }
  
  .navbar {
    padding: 0 var(--pad-sm);
    gap: var(--pad-sm);
  }
  
  .nav-links {
    gap: var(--pad-sm);
  }
  
  .lang-switcher img {
    width: 24px;
    height: 18px;
  }
  
  .small-card {
    width: 100px;
  }
  
  .logo {
    width: 70px;
    height: 70px;
  }
  
  .timeline {
    padding-left: 40px;
  }
  
  .timeline::before {
    left: 20px;
  }
  
  .dot {
    width: 40px;
    height: 40px;
  }
  
  .iframe-container {
    direction: ltr;
  }
  
  .project-iframe {
    transform: scale(0.25);
    transform-origin: top left;
  }
  
  /* Correction très petits écrans QR */
  .links-wrapper .card.line-card.corner {
    min-width: calc(var(--corner-qr-size) + 16px);
    min-height: calc(var(--corner-qr-size) + 16px + 6em);
  }
  
  .sub-section {
    min-width: calc(var(--corner-qr-size) + 16px);
  }
  button,
  .contact-form .actions button,
  .card[role="button"],
  .tg-send {
    font-size: var(--fs-body);
    padding: 0.6rem 1rem;
  }

  /* Empêcher tout débordement horizontal et forcer box-sizing */
  .section,
  .page-layout,
  .page,
  .wrapper,
  .sub-section {
    box-sizing: border-box;
    max-width: 100vw;
    overflow-x: hidden;
  }

  /* Éléments UI secondaires qui pouvaient être plus petits que 16px */
  .timeline-overlay .overlay-type,
  .timeline-overlay .overlay-info,
  .timeline-overlay .overlay-level,
  .links-wrapper .line-card small,
  .links-wrapper .line-card h3 {
    font-size: var(--fs-body) !important;
  }
}

/* -------------------------------
   POINT DE RUPTURE: 320px (Très très petits écrans)
   ------------------------------- */
@media (max-width: 320px) {
  .links-wrapper .card.line-card.corner {
    min-width: calc(var(--corner-qr-size) + 16px);
    min-height: calc(var(--corner-qr-size) + 16px + 6em);
  }
  
  .sub-section {
    min-width: calc(var(--corner-qr-size) + 16px);
  }
}

/* -------------------------------
   ORIENTATION PAYSAGE
   ------------------------------- */
@media (max-height: 500px) and (orientation: landscape) {
  .section {
    height: auto;
    min-height: calc(100vh - var(--navbar-height));
    padding: var(--pad-md) 0;
  }
  
  .sub-section {
    max-height: 80vh;
  }
  
  .navbar {
    position: relative;
  }
  
  .pages {
    height: calc(100vh - var(--navbar-height));
  }
}

/* -------------------------------
   ÉCRANS RETINA / HAUTE RÉSOLUTION
   ------------------------------- */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .logo {
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
  }
}

/* -------------------------------
   FORMULAIRE CONTACT RESPONSIVE
   ------------------------------- */
@media (max-width: 540px) {
  .popup-content {
    width: 92%;
    padding: var(--pad-sm);
  }
  
  .popup-content .contact-form.card {
    margin: 0;
    width: 100%;
    padding: var(--pad-sm);
  }
  .soft-skills-page .page-layout.grid-2x2,
  .soft-skills-page .page-layout {
    grid-template-columns: 1fr !important;
    grid-template-rows: repeat(4, auto) !important;
    grid-auto-rows: auto !important;
    row-gap: var(--sub-gap) !important;
    height: auto;
  }
  .skills-page .page-layout.grid-2x2 {
    grid-template-columns: 1fr !important;
    grid-template-rows: repeat(4, auto) !important;
    height: auto;
  }
}

/* QR responsive sur petits écrans */
@media (max-width: 640px) {
  .card.corner {
    padding-inline-end: calc(var(--corner-qr-size) + var(--corner-qr-margin-right) + var(--corner-qr-margin-left) + var(--pad-xs));
    min-height: calc(var(--corner-qr-size) + var(--corner-qr-margin-top) + 3.5em);
  }
  
  .card.corner .corner-qr {
    width: var(--corner-qr-size);
    height: var(--corner-qr-size);
    border-radius: var(--radius);
  }
}

/* ==========================================================================
   STYLES RTL (Right-To-Left)
   ========================================================================== */
/* Direction globale */
[dir="rtl"] body {
  direction: rtl;
  text-align: right;
}

/* Navbar - garde boutons en LTR */
[dir="rtl"] .navbar {
  direction: ltr;
}

/* Liste de navigation inversée */
[dir="rtl"] .nav-links {
  direction: rtl;
  justify-content: center;
}

/* Bouton thème reste à gauche */
[dir="rtl"] .theme-toggle {
  order: 0;
  direction: ltr;
}

/* Drapeaux restent à droite */
[dir="rtl"] .lang-switcher {
  order: 1;
  direction: ltr;
}

/* Timeline inversée */
[dir="rtl"] .timeline {
  padding-left: var(--pad-md);
  padding-right: 68px;
}

[dir="rtl"] .timeline::before {
  left: auto;
  right: 34px;
}

[dir="rtl"] .dot {
  left: auto;
  right: 0;
}

/* Ligne verticale à droite pour line-card */
[dir="rtl"] .line-card {
  border-left: none;
  border-right: 4px solid var(--blue);
}

/* Texte aligné à droite */
[dir="rtl"] .details {
  padding-left: 0;
  padding-right: var(--pad-md);
}

[dir="rtl"] .wrapper .title {
  text-align: right;
}

/* Corrections timeline et milestone */
[dir="rtl"] .meta,
[dir="rtl"] .category-header,
[dir="rtl"] .timeline-container {
  direction: rtl;
}

[dir="rtl"] .milestone {
  transform: translateX(50%);
}

/* Bouton popup */
[dir="rtl"] .close-btn {
  float: left;
}

/* Iframes toujours LTR */
[dir="rtl"] .iframe-container {
  direction: ltr;
}

[dir="rtl"] .project-iframe {
  transform-origin: top left;
}

/* ==========================================================================
   OVERFLOW GLOBAL
   ========================================================================== */
.page-layout,
.sub-section,
.section,
.pages,
.page {
  overflow-x: hidden;
  max-width: 100%;
}

/* Soft_Skills — card should size exactly to its text content (no clamp, no reserved QR space) */
.soft-skills-page .card {
  /* let the card size to its content */
  height: auto !important;
  min-height: 0 !important;
  box-sizing: border-box;
  padding: var(--pad-sm) var(--pad-sm);
  white-space: normal;
  overflow-wrap: anywhere;
  word-break: break-word;
  overflow: visible !important;
  display: block;
}

/* Prevent QR / corner-specific spacing from applying to soft-skills cards */
.soft-skills-page .card.corner {
  padding-inline-end: var(--pad-sm);
  background-position: center;
}

/* Soft_Skills — fixed-size cards sized to exactly 2 text lines (name + short) */
.soft-skills-page .card {
  /* fixed width for consistent layout */
  --soft-card-width: 14rem;
  width: var(--soft-card-width) !important;
  max-width: 100%;

  /* height = 2 lines * line-height + vertical padding */
  line-height: 1.25 !important; /* ensure consistent line-height */
  height: calc((1.25em * 2) + (var(--pad-sm) * 2)) !important;

  /* clamp visual overflow to exactly 2 lines */
  display: -webkit-box !important;
  -webkit-box-orient: vertical !important;
  -webkit-line-clamp: 2 !important;
  line-clamp: 2 !important;
  overflow: hidden !important;
  text-overflow: ellipsis;
  white-space: normal !important;

  box-sizing: border-box !important;
  padding: var(--pad-sm) !important;
}

/* Ensure corner/QR spacing doesn't reintroduce extra width */
.soft-skills-page .card.corner {
  padding-inline-end: var(--pad-sm) !important;
}

/* Soft_Skills — make cards larger and more airy while keeping responsive clamp */
.soft-skills-page .card {
  /* responsive fixed width: min 11rem, preferred scales with viewport, max 18rem (increased) */
  --soft-card-min: 14rem;
  --soft-card-max: 20rem; /* increased max width */
  width: clamp(var(--soft-card-min), 20vw + 1rem, var(--soft-card-max)) !important;
  max-width: 100% !important;

  /* increase line-height and height to fit 2 more airy lines */
  line-height: 1.5 !important; /* increased for legibility */
  height: calc((2em * 2) + (var(--pad-sm) * 2)) !important; /* 2 lines + vertical padding */

  /* clamp overflow to exactly 2 lines where supported */
  display: -webkit-box !important;
  -webkit-box-orient: vertical !important;
  -webkit-line-clamp: 2 !important;
  line-clamp: 2 !important;
  overflow: hidden !important;
  text-overflow: ellipsis;
  white-space: normal !important;

  box-sizing: border-box !important;
  padding: var(--pad-xs) var(--pad-sm) calc(var(--pad-sm) + 0.5rem) var(--pad-sm) !important; /* extra bottom padding */
  vertical-align: top !important;
}

/* Ensure corner/QR spacing doesn't reintroduce extra width */
.soft-skills-page .card.corner {
  padding-inline-end: var(--pad-sm) !important;
}

/* Ensure spacing between soft-skills cards matches spacing between sub-sections */
.soft-skills-page .grid {
  display: flex;
  flex-wrap: wrap;
  gap: var(--sub-gap) !important; /* use same gap as sub-sections */
  align-items: flex-start;
}

/* Reset individual skill-item margins so gap controls spacing */
.soft-skills-page .skill-item {
  margin: 0 !important;
  width: auto !important;
  box-sizing: border-box;
}
